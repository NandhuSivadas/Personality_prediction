<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Personality Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/favicon.png') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <span class="body-bg-shape shape-a"></span>
    <span class="body-bg-shape shape-b"></span>
    <span class="body-bg-shape shape-c"></span>
    <span class="body-bg-shape shape-d"></span>
    <span class="body-bg-shape shape-e"></span>
    <span class="body-bg-shape shape-f"></span>
    <span class="body-bg-shape shape-g"></span>
    <span class="body-bg-shape shape-h"></span>
    <span class="body-bg-shape shape-i"></span>
    <span class="body-bg-shape shape-j"></span>
    <span class="body-bg-shape shape-k"></span>
    <span class="body-bg-shape shape-l"></span>
    <span class="body-bg-shape shape-m"></span>
    <span class="body-bg-shape shape-n"></span>
    <span class="body-bg-shape shape-o"></span>
    <span class="body-bg-shape shape-p"></span>

    <div class="container">
        <h1>Your Personality Profile</h1>
        <p style="text-align: center;">Here are your scores based on the Big Five personality model. Scores are shown from 0 to 100.</p>

        <div class="results-grid">
            <div class="chart-container">
                <h3>Trait Overview</h3>
                <canvas id="radarChart"></canvas>
            </div>

            <div class="progress-container">
                <h3>Trait Scores</h3>
                {% for trait, score in results %}
                <div class="progress-bar-label">{{ trait }}</div>
                <div class="progress-bar-wrapper">
                    <div class="progress-bar-result trait-{{ trait|lower }}" style="width: {{ score }}%;">
                        {{ "%.1f"|format(score) }}%
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="summary-section summary-highlight">
            <div class="summary-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
            </div>
            <h3>Your Standout Trait</h3>
            <p>Your highest scoring trait is <strong>{{ highest_trait[0] }}</strong> ({{ "%.1f"|format(highest_trait[1]) }}%).</p>
        </div>

        <div class="button-container">
            <a href="{{ url_for('career_suggestions') }}" class="btn btn-secondary">Get Career Suggestions</a>
            <a href="{{ url_for('personal_growth') }}" class="btn btn-secondary">Get Personal Growth Tips</a>
            <a href="{{ url_for('start_test') }}" class="btn btn-primary">Take the Test Again</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            try {
                const labels = {{ labels_json | safe }};
                const data = {{ scores_json | safe }};

                // Your site's purple theme colors
                const primaryColor = 'rgb(108, 92, 231)';
                // A slightly darker, more solid fill
                const primaryColorFill = 'rgba(108, 92, 231, 0.4)'; 
                const gridColor = 'rgba(0, 0, 0, 0.25)'; // A crisp, light grid
                const labelColor = '#2c3e50';

                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Score',
                            data: data,
                            
                            // --- NEW DATA STYLING ---
                            fill: true, // This makes it a solid shape
                            backgroundColor: primaryColorFill,
                            borderColor: primaryColor,
                            borderWidth: 2,
                            pointRadius: 4,
                            pointBackgroundColor: primaryColor,
                            pointBorderColor: '#fff',
                            pointHoverRadius: 7,
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: primaryColor
                        }]
                    },
                    options: {
                        // --- NEW PROFESSIONAL OPTIONS ---
                        scales: {
                            r: {
                                // --- Grid & Angle Lines ---
                                angleLines: { 
                                    display: true,
                                    color: gridColor 
                                },
                                grid: {
                                    color: gridColor,
                                    circular: false // THIS IS THE "FLOPPY" FIX!
                                },
                                suggestedMin: 0,
                                suggestedMax: 100,
                                
                                // --- 0, 20, 40... Ticks ---
                                ticks: {
                                    backdropColor: 'rgba(255, 255, 255, 0.5)',
                                    color: '#555',
                                    backdropPadding: 4,
                                    font: {
                                        weight: '600' // Bolder ticks
                                    }
                                },
                                
                                // --- "Openness", "Agreeableness" Labels ---
                                pointLabels: {
                                    font: {
                                        family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif', // Use site font
                                        size: 14,
                                        weight: '700'
                                    },
                                    color: labelColor
                                }
                            }
                        },
                        plugins: {
                            legend: { 
                                display: false 
                            },
                            tooltip: {
                                backgroundColor: '#2c3e50',
                                titleColor: '#fff',
                                bodyColor: '#fff',
                                borderRadius: 8,
                                padding: 10,
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.r !== null) {
                                            label += context.parsed.r.toFixed(1) + '%';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (e) {
                console.error("Error creating chart:", e);
                const container = document.querySelector('.chart-container');
                container.innerHTML = "<h3>Error</h3><p>Could not load chart data. Please try again.</p>";
            }
        });
    </script>

    <script src="{{ url_for('static', filename='js/mouse_parallax.js') }}"></script>
</body>
</html>